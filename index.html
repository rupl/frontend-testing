<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>Automated Frontend Testing</title>

    <meta name="description" content="Intro to Frontend Ops - learn how to get started with frontend development, focused primarily on workflow automation.">
    <meta name="author" content="Chris Ruppel">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>

    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/print.css" type="text/css" media="print">

    <link rel="stylesheet" href="lib/github.css">
    <link rel="stylesheet" href="lib/prism.css">
  </head>

  <body>

    <div class="reveal">

      <!-- Used to fade in a background when a specific slide state is reached -->
      <div class="state-background"></div>

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
        <section data-state="bluesy">
          <br><br>
          <h1 style="font-size: 3.2em; ">Austomated Frontend Testing</h1><br>
          <p class="fragment">Or: How to Automate the Process of <span class="insert">detecting when you</span> Break Things</p>
          <script>
            // Delicously hacky. Look away.
            if( navigator.userAgent.match( /(iPhone|iPad|iPod|Android)/i ) ) document.write( '<p style="color: rgba(0,0,0,0.3); text-shadow: none;">('+'Tap to navigate'+')</p>' );
          </script>
        </section>

        <section>
          <h2>Chris Ruppel</h2>
          <section>
            <br><br>
            <p>frontend dev @ <a href="http://fourkitchens.com">Four Kitchens</a></p>
            <p><a href="http://twitter.com/rupl">twitter.com/rupl</a></p>
            <p><a href="https://github.com/rupl">github.com/rupl</a></p>
          </section>
          <section>
            <a href="http://fourkitchens.com"><img src="img/4k-logo-square-500px.png" alt="Four Kitchens" style="border: 0; box-shadow: none; "></a><br>
            <small><a href="http://fourkitchens.com/careers">(we're hiring!)</a></small>
          </section>
          <section>
            <br><br>
            <p style="font-size: 1.25em;">I contribute and present about open source:</p><br>
            <ul class="fragment">
              <li><a href="http://rupl.github.io/unfold/">Unfolding the Box Model</a>
              <li><a href="https://drupal.org/project/modernizr">Modernizr Drupal module</a>
              <li><a href="https://drupal.org/project/fastclick">FastClick Drupal module</a>
              <li><a href="https://drupal.org/project/pre">Prerender/Prefetch Drupal module</a>
              <li><a href="https://github.com/fourkitchens/jekyll-schedule">jekyll-schedule</a>
            </ul>
          </section>
        </section>

        <section>
          <h2>Differences from server-side testing</h2>
          <section>
            <br><br>
            <p class="fragment">None: if you're familiar with server-side testing, this is <strong style="font-size: 1.4em;">not</strong> new.</p>
            <br>
            <p class="fragment">However, since frontend is a different game than backend, its operational needs are slightly different.</p>
          </section>
          <section>
            <br><br>
            <p>Often, a PHP error results in a 500 or<br> blank page. You either get HTML or not.</p>
            <br><br>
            <p class="fragment">(or you can at least use XHProf)</p>
            <br>
          </section>
          <section>
            <br>
            <p>There are untold number of subtle<br> errors that can occur on the frontend.</p>
            <br>
            <ul>
              <li class="fragment">Minor CSS changes that throw things off</li>
              <li class="fragment">Changes to JS files that break things</li>
              <li class="fragment">Aggregates changing when not necessary</li>
              <li class="fragment">Performance regressions<br><br></li>
            </ul>
          </section>
          <section>
            <br>
            <p>Additionally, frontend development is<br> becoming more critical as the trade matures.</p>
            <br>
            <p class="fragment">We need the same testing abilities<br> that the backend has had for years.</p>
            <br>
            <ul class="fragment">
              <li>Testing page load times</li>
              <li>Testing render speeds</li>
              <li>Sticking to a performance budget</li>
              <li>Accountability for code changes</li>
            </ul>
          </section>
        </section>

        <section data-state="soothe">
          <section>
            <h2>workflow_alter()</h2>
            <br>
            <p>In order to deliver the best, fastest site possible, we have to change our development processes.</p>
            <br>
            <blockquote class="fragment" cite="http://www.igvita.com/slides/2013/io-pagespeed.pdf"><q>Performance is not a checklist, it's a<br> <strong>continuous</strong> process.</q> — <a href="http://www.igvita.com/slides/2013/io-pagespeed.pdf">Ilya Grigorik</a></blockquote>
            <br>
            <blockquote class="fragment" cite="http://www.netmagazine.com/features/speeding-mobile-html5-experiences"><q>&hellip;don’t take measures without measuring them.</q><br> — <a href="http://www.netmagazine.com/features/speeding-mobile-html5-experiences">Maximiliano Firtman</a></blockquote>
          </section>
        </section>

        <section>
            <h1>YES</h1>
            <br>
            <p class="fragment">The slides AND code are on GitHub, I will tweet the link, and it's already available on the session page of the DrupalCon site. Yes, you may <a href="https://github.com/rupl/frontend-testing/blob/gh-pages/LICENSE.md">take code from the slides</a> and use it for any purpose :)</p>
            <br>
            <p class="fragment">This presentation is using a fresh clone of these slides, using the many <a href="https://github.com/rupl/frontend-testing/tree/gh-pages/examples">examples I provided in the repo</a>.</p>
        </section>

        <section>
          <section data-state="blackout">
            <br>
            <h1>Performance Testing</h1>
          </section>
          <section>
            <h2>Automating YSlow</h2>
            <br>
            <p class="fragment"><a href="http://developer.yahoo.com/yslow/">YSlow</a> is a service that grades frontend performance based on many tried and true facets. Developed at Yahoo! when they were the kings of perf.</p>
            <br>
            <p class="fragment">It delivers A-F on the various tests, but historically required the user to visit each page in a browser.</p>
          </section>
          <section>
            <pre><code class="language-bash"># capture a HAR file from the CLI
$ phantomjs examples/netsniff.js http://example.com/ > ex.har

# install/run YSlow on the waterfall (node.js)
$ npm install yslow -g
$ yslow --info basic --format plain ex.har

# Full grade report of FK website, all in one line
$ phantomjs examples/netsniff.js http://fourkitchens.com | yslow --info grade --format plain
</code></pre>
            <small>Original code compliments of <a href="http://www.igvita.com/slides/2012/devtools-tips-and-tricks/#11">Ilya Grigorik</a></small>
            <br>
            <small><a href="http://yslow.org/phantomjs/">YSlow also has a phantomjs package</a></small>
          </section>
          <section>
            <h2>Automating PageSpeed</h2>
            <br>
            <p class="fragment">Not to be outdone by Yahoo, Google has a<br> competing service called <a href="https://developers.google.com/speed/pagespeed/insights/">PageSpeed Insights</a>.</p>
            <br>
            <p class="fragment">
              It can also be automated, by <a href="https://developers.google.com/speed/docs/insights/v1/getting_started#auth">getting an API key</a>.
              <br><br>
              Or signing up for <a href="https://developers.google.com/speed/pagespeed/service">PageSpeed service</a>.
            </p>
          </section>
          <section>
            <h2>grunt-pagespeed</h2>
            <br>
            <p><a href="https://developers.google.com/speed/docs/insights/v1/getting_started">PageSpeed API</a> is documented quite<br> thoroughly, but there's also a <a href="https://github.com/jrcryer/grunt-pagespeed">grunt plugin</a>.</p>
            <br>
            <pre><code class="language-bash"># examples/grunt/pagespeed
$ npm install
$ grunt # runs default task
$ grunt pagespeed:mobile # runs mobile task</code></pre>
            <br>
            <small><a href="https://github.com/rupl/frontend-testing/tree/gh-pages/examples/grunt/pagespeed">View code on GitHub</a></small>
          </section>
          <section>
            <h2>Phantomas</h2>
            <br>
            <p class="fragment"><a href="https://github.com/macbre/phantomas">Phantomas</a> is a PhantomJS-based<br> web performance metrics tool</p>
            <br>
            <p class="fragment">It gives you loads of data about how the<br> frontend of your website is performing.</p>
            <br>
            <p class="fragment">The <a href="https://github.com/macbre/phantomas#usage">usage guide</a> is extensive.</p>
          </section>
          <section>
            <pre><code class="language-bash"># install via npm
$ npm install -g phantomas

# run a basic report
$ phantomas --url http://example.com

# set viewport dimensions, generate images of rendering process
$ phantomas --url http://example.com --viewport=320x480 --film-strip

# assert a test for total number of requests
$ phantomas --url http://example.com --assert-requests=20
</code></pre>
          </section>
          <section>
            <h2>grunt-phantomas</h2>
            <br><br>
            <p class="fragment">The grunt plugin is not just<br> a wrapper for running the tool.</p>
            <br><br>
            <p class="fragment">It makes reporting trends easier<br> with charts that update each<br> time you run the grunt task</p>
          </section>
          <section>
            <pre><code class="language-bash"># examples/grunt/phantomas
$ npm install

# run report
$ grunt phantomas:default

# run report and generate screenshot
$ grunt phantomas:screenshot

# test for certain values. this might cause failure!
$ grunt phantomas:requests
</code></pre>
            <br>
            <small><a href="https://github.com/rupl/frontend-ops/tree/master/examples/grunt/phantomas">View code on GitHub</a></small>
          </section>
        </section>

        <section>
          <section>
            <h2>CSS Regression testing</h2>
            <br>
            <p class="fragment">CSS regressions? say it ain't so!</p>
            <br>
            <p class="fragment">Having no scope at all, CSS is the easiest thing to nudge out of place. It's easier to prevent than you think.</p>
          </section>
          <section>
            <h2>Wraith</h2>
            <p class="fragment">Wraith uses either Phantom or Slimer (your choice) to take screenshots of two environments, producing a visual diff of the two screenshots!</p>
            <img class="fragment" src="https://github-camo.global.ssl.fastly.net/189a0458120b8dff072ec77df204f3d6aaf63986/687474703a2f2f6262632d6e6577732e6769746875622e696f2f7772616974682f696d616765732f3332305f646966662e706e67">
          </section>
          <section>
            <h3>Basic usage of Wraith</h3>
            <br>
            <pre><code class="language-bash"># examples/wraith
$ ./install.sh
$ cd wraith
$ rake # runs their example against bbc.co.uk
$ open shots/gallery.html # view results in the browser</code></pre>
          </section>
          <section>
            <h3>Multiple tests</h3>
            <br>
            <p>Wraith handles one comparison per config file.</p>
            <br>
            <p class="fragment">However, it has support for multiple configs, so several config files in one repo allows for multiple comparisons.</p>
            <br>
            <pre class="fragment"><code class="language-bash">$ cd /path/to/wraith/configs
$ rake config[homepage]
$ rake config[dashboard]</code></pre>
          </section>
        </section>

        <section>
          <section>
            <h2>Setting up prerender</h2>
            <br><br>
            <p class="fragment"><a href="http://rupl.github.io/prerender/">Prerender</a> is relatively new, and lets you<br> pre-load whole pages before a user clicks.</p>
            <br><br>
            <p class="fragment">Since it's a heavy-handed but super-useful optimization, you MUST make sure it is only used in situations where it's absolutely appropriate.</p>
          </section>
          <section>
            <p>Google Analytics &mdash; <strong>Audience &#187; Visitors Flow</strong></p>
            <img src="img/visitor-flow.png" alt="Screenshot of Google Analytics diagram for Visitor Flow.">
          </section>
          <section>
            <h3>..or you can automate the hunt!</h3>
            <br>
            <pre><code class="language-bash"># examples/prerender
$ ruby report.rb login@gmail.com password UA-XXXXXX-Y</code></pre>
            <small>Original code compliments of <a href="https://gist.github.com/igrigorik/a491cc732b5d4627e193#file-report-rb">Ilya Grigorik</a></small>
          </section>
        </section>

        <section>
          <section>
            <h2>QA and Testing</h2>
            <br><br>
            <p class="fragment">Testing in loads of browsers is a<br> necessary but tedious task.</p>
            <br><br>
            <p class="fragment">Services like <a href="http://browserstack.com">BrowserStack.com</a><br> make testing much simpler.</p>
          </section>
          <section data-state="big-img">
            <img class="bare" style="margin-top: -200px; " src="img/browserstack-screenshots.png" alt="visit browserstack.com/screenshots to automatically test in over 300 browsers.">
          </section>
        </section>

        <section data-state="blackout">
          <section>
            <h1>Automating Tasks with CI</h1>
          </section>
          <section>
            <h2>The Basics</h2>
            <br>
            <p class="fragment">Everything outlined in this section<br> requires two key ingredients:</p>
            <br>
            <ul class="fragment">
              <li>Continuous integration (CI)</li>
              <li><a href="http://git-scm.com/book/ch7-3.html">Git hooks</a></li>
            </ul>
            <br><br>
            <p class="fragment">Four Kitchens uses <a href="http://jenkins-ci.org/">Jenkins</a> and <a href="https://help.github.com/articles/post-receive-hooks">GitHub WebHooks</a><br> in our workflow, and you can use whatever you wish.</p>
          </section>
        </section>

        <section>
          <h2>Trigger Jenkins builds<br> by pushing to GitHub</h2>
          <br>
          <p class="fragment">An oldie but goodie: <a href="http://fourkitchens.com/blog/2011/09/20/trigger-jenkins-builds-pushing-github">check out our how-to from 2011</a></p>
          <br>
          <ol class="fragment">
            <li>You push to GitHub master branch (or merge PR)</li>
            <li>GitHub sends a message to your CI server</li>
            <li><em>"Yo Jenkins, the repository was updated!"</em></li>
            <li>CI server pulls the new code to your staging area</li>
          </ol>
          <br>
          <br>
          <p class="fragment">Although fairly mundane in terms of CI, the blog post illustrates the basic concepts underlying all of the tasks involving Jenkins.</p>
        </section>

        <section>
          <br>
          <h2>Further reading</h2>
          <br>
          <ul>
            <li><a href="http://www.smashingmagazine.com/2013/06/11/front-end-ops/">Frontend Ops</a> by <a href="https://twitter.com/slexaxton">@SlexAxton</a></li>
            <li><a href="https://speakerdeck.com/addyosmani/automating-front-end-workflow">Automating Frontend Workflow</a> by <a href="https://twitter.com/addyosmani">@addyosmani</a></li>
            <li><a href="http://yeoman.io/blog/performance-optimization.html">Grunt/Gulp tasks for Performance Optimization</a></li>
            <li><small style="position: relative; top: 12px;"><a href="http://24ways.org/2013/grunt-is-not-weird-and-hard/">Grunt for People Who Think Things Like Grunt are Weird and Hard</a> by <a href="https://twitter.com/chriscoyier">@ChrisCoyier</a></small></li>
          </ul>
        </section>

        <section data-state="blackout">
          <h1>Questions?</h1>
          <br>
          <p>Contact me:</p>
          <p><a href="https://drupal.org/user/411999">drupal.org/user/411999</a></p>
          <p><a href="https://github.com/rupl">github.com/rupl</a></p>
          <p><a href="http://twitter.com/rupl">twitter.com/rupl</a></p>
          <p>chris &#x2740; fourkitchens.com</p>
        </section>

        <!-- section data-state="bluesy">
          <h2>Rate this session!</h2>
          <p>
            <a href="https://prague2013.drupal.org/session/frontend-ops">Visit the session page</a> to leave feedback.<br>
            <small>It means a lot to me ❤ Thanks!</small><br><br>
            Short link: <a href="http://j.mp/dcprague-fops">http://j.mp/dcprague-fops</a><br><br>
            Select <i>"Provide feedback on this session"</i>
          </p>
        </section -->
      </div>

      <!-- The navigational controls UI -->
      <aside class="controls">
        <a class="left" href="#">&#x25C4;</a>
        <a class="right" href="#">&#x25BA;</a>
        <a class="up" href="#">&#x25B2;</a>
        <a class="down" href="#">&#x25BC;</a>
      </aside>

      <!-- Displays presentation progress, max value changes via JS to reflect # of slides -->
      <div class="progress"><span></span></div>

    </div>

    <!-- Optional libraries for code syntax highlighting and classList support in IE9 -->
    <script src="lib/classList.js"></script>
    <script src="lib/prism.js"></script>

    <script src="js/reveal.js"></script>

    <script>
      // Parse the query string into a key/value object
      var query = {};
      location.search.replace( /[A-Z0-9]+?=(\w*)/gi, function(a) {
        query[ a.split( '=' ).shift() ] = a.split( '=' ).pop();
      } );

      // Fires when a slide with data-state=customevent is activated
      Reveal.addEventListener( 'customevent', function() {
        alert( '"customevent" has fired' );
      } );

      // Fires each time a new slide is activated
      Reveal.addEventListener( 'slidechanged', function( event ) {
        // event.previousSlide, event.currentSlide, event.indexh, event.indexv
      } );

      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,
        // Display a presentation progress bar
        progress: true,
        // If true; each slide will be pushed to the browser history
        history: true,
        // Loops the presentation, defaults to false
        loop: false,
        // Flags if mouse wheel navigation should be enabled
        mouseWheel: true,
        // Apply a 3D roll to links on hover
        rollingLinks: true,
        // UI style
        theme: query.theme || 'default', // default/neon
        // Transition style
        transition: query.transition || 'linear' // default/cube/page/concave/linear(2d)
      });
    </script>
  </body>
</html>
